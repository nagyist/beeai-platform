# check

["agentstack-ui:check"]
depends = ["agentstack-ui:check:*"]

["agentstack-ui:check:prettier"]
extends = "node:check:prettier"
depends = ["common:setup:pnpm"]
dir = "{{config_root}}/apps/agentstack-ui"

["agentstack-ui:check:eslint"]
extends = "node:check:eslint"
depends = ["common:setup:pnpm"]
dir = "{{config_root}}/apps/agentstack-ui"

["agentstack-ui:check:tsc"]
extends = "node:check:tsc"
depends = ["common:setup:pnpm", "agentstack-sdk-ts:build"]
dir = "{{config_root}}/apps/agentstack-ui"
run = "pnpm tsc --noEmit -p tsconfig.check.json"

["agentstack-ui:check:stylelint"]
extends = "node:check:stylelint"
depends = ["common:setup:pnpm"]
dir = "{{config_root}}/apps/agentstack-ui"

["agentstack-ui:check:hadolint"]
extends = "docker:check:hadolint"
dir = "{{config_root}}/apps/agentstack-ui"

# fix

["agentstack-ui:fix"]
depends = ["agentstack-ui:fix:*"]

["agentstack-ui:fix:prettier"]
extends = "node:fix:prettier"
depends = ["common:setup:pnpm"]
dir = "{{config_root}}/apps/agentstack-ui"

["agentstack-ui:fix:next"]
extends = "node:fix:eslint"
depends = ["common:setup:pnpm"]
dir = "{{config_root}}/apps/agentstack-ui"

["agentstack-ui:fix:stylelint"]
extends = "node:fix:stylelint"
depends = ["common:setup:pnpm"]
dir = "{{config_root}}/apps/agentstack-ui"
run = "pnpm stylelint --fix=lax \"src/**/*.css\" \"src/**/*.scss\""

# run

["agentstack-ui:run"]
depends = ["agentstack-ui:build:nextjs"]
env.NODE_OPTIONS = "--no-experimental-global-navigator"
dir = "{{config_root}}/apps/agentstack-ui"
run = "pnpm next start"

["agentstack-ui:run:dev"]
depends = ["common:setup:pnpm", "agentstack-sdk-ts:build"]
env.NODE_OPTIONS = "--no-experimental-global-navigator"
dir = "{{config_root}}/apps/agentstack-ui"
# Using --webpack because Turbopack doesnâ€™t yet support some required features (e.g. the ::highlight() CSS rule).
run = "pnpm next dev --webpack"

# build

["agentstack-ui:build"]
depends = ["agentstack-ui:build:*"]
dir = "{{config_root}}"
run = "docker build -t ghcr.io/i-am-bee/agentstack/agentstack-ui:local -f ./apps/agentstack-ui/Dockerfile --load ."

["agentstack-ui:build:nextjs"]
depends = ["common:setup:pnpm", "agentstack-sdk-ts:build"]
dir = "{{config_root}}/apps/agentstack-ui"
env.NODE_OPTIONS = "--no-experimental-global-navigator"
run = "pnpm next build --webpack"
sources = [
    "package.json",
    "next.config.ts",
    "tsconfig.json",
    "public/**/*",
    "src/**/*",
]
outputs = [".next/standalone/**/*"]

# schema

["agentstack-ui:schema:generate"]
dir = "{{config_root}}/apps/agentstack-ui"
run = "./scripts/generate-schema.sh http://localhost:8333/api/v1/openapi.json ./src/api/schema.d.ts"
